spec: v1.0.0
node:
  id: video_splitter
  title: Video Splitter
  description: Splits video files into MP4 chunks of configurable duration
  version: 1.0.0
  type: utility
  integration:
    config:
      lambda:
        handler: utility/VideoSplitterLambdaDeployment
        runtime: python3.12
        memory_size: 2048 # Increased memory for video processing
        ephemeral_storage: 10240 # Default ephemeral storage
        timeout: 900
        layers:
          - FFmpeg
        iam_policy:
          statements:
            - effect: Allow
              actions:
                - s3:ListBucket
                - s3:GetObject
                - s3:PutObject
              resources:
                - arn:aws:s3:::${MEDIA_ASSETS_BUCKET_NAME}/*
                - arn:aws:s3:::${MEDIA_ASSETS_BUCKET_NAME}
            - effect: Allow
              actions:
                - kms:Decrypt
              resources:
                - ${MEDIA_ASSETS_BUCKET_ARN_KMS_KEY}
            - effect: Allow
              actions:
                - kms:GenerateDataKey
              resources:
                - "*"

actions:
  split:
    summary: Video Splitter
    description: Splits video files into MP4 chunks of configurable duration
    operationId: videoSplitter
    parameters:
      - in: body
        name: Chunk Duration
        required: true
        default: 7200
        schema:
          type: number
    connections:
      incoming:
        type: [video]
      outgoing:
        type: [video]
