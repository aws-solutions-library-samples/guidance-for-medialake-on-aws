{
  "name": "TwelveLabs Bedrock Image Embedding to S3 Vectors",
  "description": "",
  "active": true,
  "configuration": {
    "nodes": [
      {
        "id": "dndnode_5",
        "type": "custom",
        "position": {
          "x": 640,
          "y": 400
        },
        "data": {
          "nodeId": "wait",
          "label": "Wait (wait)",
          "description": "This step will wait for a specific duration before moving to the next step",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["any"],
          "outputTypes": [
            {
              "name": "any",
              "description": "Output type: any"
            }
          ],
          "type": "FLOW",
          "configuration": {
            "path": "",
            "operationId": "",
            "method": "wait",
            "parameters": {
              "Duration": "15"
            }
          },
          "id": "wait"
        },
        "width": 200,
        "height": 113
      },
      {
        "id": "dndnode_10",
        "type": "custom",
        "position": {
          "x": 320,
          "y": 400
        },
        "data": {
          "nodeId": "choice",
          "label": "Choice",
          "description": "This step will branch the workflow based on a condition",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["any"],
          "outputTypes": [
            {
              "name": "Completed",
              "description": "Path taken when condition evaluates to true"
            },
            {
              "name": "In Progress",
              "description": "Path taken when condition evaluates to false"
            },
            {
              "name": "Fail",
              "description": "Path taken when condition evaluates to false"
            }
          ],
          "type": "FLOW",
          "configuration": {
            "method": "choice",
            "parameters": {}
          },
          "id": "choice"
        },
        "width": 200,
        "height": 113
      },
      {
        "id": "dndnode_11",
        "type": "custom",
        "position": {
          "x": 672,
          "y": 560
        },
        "data": {
          "nodeId": "fail",
          "label": "Fail (fail)",
          "description": "This step will end the state machine execution with a failure status",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["any"],
          "outputTypes": [],
          "type": "FLOW",
          "configuration": {
            "path": "",
            "operationId": "",
            "method": "fail",
            "parameters": {
              "Error": "Failed",
              "Cause": "Flow step failed"
            }
          },
          "id": "fail"
        },
        "width": 200,
        "height": 113
      },
      {
        "id": "dndnode_15",
        "type": "custom",
        "position": {
          "x": 848,
          "y": 208
        },
        "data": {
          "nodeId": "twelvelabs_bedrock_status",
          "label": "TwelveLabs Bedrock Status",
          "description": "Check if TwelveLabs Bedrock embedding job is complete by polling S3",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["invocation_arn", "any"],
          "outputTypes": [
            {
              "name": "status",
              "description": "Output type: status"
            }
          ],
          "type": "INTEGRATION",
          "configuration": {
            "method": "check_status",
            "parameters": {}
          },
          "id": "twelvelabs_bedrock_status"
        },
        "width": 200,
        "height": 113
      },
      {
        "id": "dndnode_16",
        "type": "custom",
        "position": {
          "x": 944,
          "y": 400
        },
        "data": {
          "nodeId": "twelvelabs_bedrock_results",
          "label": "TwelveLabs Bedrock Results",
          "description": "Retrieve and parse embedding results from completed TwelveLabs Bedrock job",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["invocation_arn", "any"],
          "outputTypes": [
            {
              "name": "embeddings",
              "description": "Output type: embeddings"
            }
          ],
          "type": "INTEGRATION",
          "configuration": {
            "method": "get_results",
            "parameters": {}
          },
          "id": "twelvelabs_bedrock_results"
        },
        "width": 200,
        "height": 113
      },
      {
        "id": "dndnode_20",
        "type": "custom",
        "position": {
          "x": 320,
          "y": 208
        },
        "data": {
          "nodeId": "trigger_image_processing_completed",
          "label": "Image Processing Completed (trigger)",
          "description": "This step will trigger after image processing is completed",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["any"],
          "outputTypes": [
            {
              "name": "image",
              "description": "Output type: image"
            }
          ],
          "type": "TRIGGER",
          "configuration": {
            "path": "",
            "operationId": "",
            "method": "trigger",
            "parameters": {
              "Prefix": ""
            },
            "requestMapping": null,
            "responseMapping": null
          },
          "id": "trigger_image_processing_completed"
        },
        "width": 200,
        "height": 113
      },
      {
        "id": "dndnode_21",
        "type": "custom",
        "position": {
          "x": 608,
          "y": 208
        },
        "data": {
          "nodeId": "twelvelabs_bedrock_invoke",
          "label": "TwelveLabs Bedrock Invoke (invoke)",
          "description": "Start async embedding generation using TwelveLabs Marengo 2.7 on Bedrock",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["video", "audio", "image"],
          "outputTypes": [
            {
              "name": "invocation_arn",
              "description": "Output type: invocation_arn"
            }
          ],
          "type": "INTEGRATION",
          "configuration": {
            "method": "invoke",
            "parameters": {
              "Model ID": "twelvelabs.marengo-embed-2-7-v1:0",
              "Region": "us-east-1",
              "S3 Output Bucket": "${EXTERNAL_PAYLOAD_BUCKET}"
            },
            "path": "",
            "operationId": ""
          },
          "id": "twelvelabs_bedrock_invoke"
        },
        "width": 200,
        "height": 113,
        "selected": false,
        "dragging": false
      },
      {
        "id": "dndnode_22",
        "type": "custom",
        "position": {
          "x": 1216,
          "y": 400
        },
        "data": {
          "nodeId": "s3_vector_store",
          "label": "S3 Vectors (store)",
          "description": "Store vector embeddings in S3 with metadata",
          "icon": {
            "key": null,
            "ref": null,
            "props": {
              "size": 20
            },
            "_owner": null
          },
          "inputTypes": ["any"],
          "outputTypes": [],
          "type": "UTILITY",
          "configuration": {
            "method": "store",
            "parameters": {
              "Vector Bucket Name": "${VECTOR_BUCKET_NAME}",
              "Index Name": "${INDEX_NAME}"
            },
            "path": "",
            "operationId": ""
          },
          "id": "s3_vector_store"
        },
        "width": 200,
        "height": 100,
        "selected": false,
        "dragging": false
      }
    ],
    "edges": [
      {
        "id": "reactflow__edge-dndnode_10In Progress-dndnode_5input-any",
        "source": "dndnode_10",
        "target": "dndnode_5",
        "type": "custom",
        "data": {
          "type": "custom",
          "text": "Connected",
          "id": "dndnode_4-dndnode_5"
        },
        "sourceHandle": "In Progress",
        "targetHandle": "input-any"
      },
      {
        "id": "dndnode_10-dndnode_11",
        "source": "dndnode_10",
        "target": "dndnode_11",
        "type": "custom",
        "data": {
          "text": "Connected"
        },
        "sourceHandle": "Fail",
        "targetHandle": "input-any"
      },
      {
        "id": "dndnode_15-dndnode_10",
        "source": "dndnode_15",
        "target": "dndnode_10",
        "type": "custom",
        "data": {
          "text": "Connected"
        },
        "sourceHandle": "status",
        "targetHandle": "input-any"
      },
      {
        "id": "dndnode_5-dndnode_15",
        "source": "dndnode_5",
        "target": "dndnode_15",
        "type": "custom",
        "data": {
          "text": "Connected"
        },
        "sourceHandle": "any",
        "targetHandle": "input-invocation_arn"
      },
      {
        "id": "dndnode_10-dndnode_16",
        "source": "dndnode_10",
        "target": "dndnode_16",
        "type": "custom",
        "data": {
          "text": "Connected"
        },
        "sourceHandle": "Completed",
        "targetHandle": "input-invocation_arn"
      },
      {
        "source": "dndnode_20",
        "sourceHandle": "image",
        "target": "dndnode_21",
        "targetHandle": "input-image",
        "id": "dndnode_20-dndnode_21",
        "type": "custom",
        "data": {
          "text": "Connected"
        }
      },
      {
        "source": "dndnode_16",
        "sourceHandle": "embeddings",
        "target": "dndnode_22",
        "targetHandle": "input-any",
        "id": "dndnode_16-dndnode_22",
        "type": "custom",
        "data": {
          "text": "Connected"
        }
      },
      {
        "source": "dndnode_21",
        "sourceHandle": "invocation_arn",
        "target": "dndnode_15",
        "targetHandle": "input-invocation_arn",
        "id": "dndnode_21-dndnode_15",
        "type": "custom",
        "data": {
          "text": "Connected"
        }
      }
    ],
    "settings": {
      "autoStart": false,
      "retryAttempts": 3,
      "timeout": 3600
    }
  }
}
